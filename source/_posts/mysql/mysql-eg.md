---
title: 数据库优化之实例和故事
date: 2017-03-02 09:24:35
tags: [mysql,优化]
categories: [后端,mysql]
cover: data:image/jpeg;base64,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
---

>简要：每一项技术都离不开数据库，数据库犹如人的大脑；密不可分，一旦出了问题（故障），停顿，卡主后果可想而知；潜心学习数据库优化3个月，现在将学到的经验分享给大家，希望能够跟各位PHP大神分享和学习探索，如果有不对或者好的建议告知下；*~*！

## 合理时间备份数据

> 备份数据，是每个项目维护的日常工作；有利于数据在系统遭受破坏或其他特定情况下,重新加以利用的一个过程；项目的备份时间，大都是根据项目需求来决定，比如：每小时，指定时间等；　

　**案例:**   某个项目正进行大型活动，数据库由于巨大用户量的访问以及定时备份；造成带宽出现峰值，大量执行操作处于队列状态，致使数据库停止工作；

　**方法：**

1. 若拓扑结构单一结构（单台数据库），停止定时任务（备份）；
2. 若拓扑结构非单一结构（主从/分布式），可停止定时任务；或主（数据库）放弃执行定时任务，从（数据库）执行；

###二、避免对大表操作

> 何谓大表，是指记录行数巨大，单标超过千万行；表数据文件巨大，表数据文件超过10G；

**（1） 慢查询**
很难在一定时间内过滤出所需要的数据，原因：来源少->区分度低->大量磁盘IO->降低磁盘效率->大量慢查询

 **（2）大表对DDL操作**

　- 建立索引需要很长的时间，过程可能会造成：主从延迟、锁表甚至于造成死锁

　- 修改表结构需要长时间锁表，过程可能会造成：主从延迟，锁表，阻塞

**方法：**
　1. 分库分表
　2. 数据归档：减少前后端业务影响
        

## 大事务

> 大事务，运行时间比较长，操作的数据比较多的事务

**（1）风险**

*  锁定太多数据，造成大量的阻塞
*  回滚时间比较长
*  执行时间长，容易造成主从延迟

**（2）方法**

 *  避免一次处理太多的数据（增删改查）
 *  移除不必要在事务中的select操作


----------
